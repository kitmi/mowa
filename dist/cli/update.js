'use strict';const Npm=require('silent-npm-registry-client'),Util=require('rk-utils'),Promise=Util.Promise,pkg=require('../../package.json');module.exports=function(api){return new Promise(function(resolve,reject){const params={timeout:1000,package:pkg.name,auth:{}},npm=new Npm,uri='https://registry.npmjs.org/npm';npm.distTags.fetch(uri,params,function(err,res){if(err){api.log('warn',err.message);resolve();return}const npmVersion=res.latest,local=pkg.version.split('.').map(n=>Number(n)),remote=npmVersion.split('.').map(n=>Number(n)),available=remote[0]>local[0]||remote[0]===local[0]&&remote[1]>local[1]||remote[1]===local[1]&&remote[2]>local[2];if(available){console.log(`New mowa version available: ${npmVersion}, current version: ${pkg.version}`);console.log()}resolve()})})};module.exports.version=pkg.version;